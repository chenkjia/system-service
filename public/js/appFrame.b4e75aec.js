(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["appFrame"],{"0bd3":function(t,e,n){"use strict";var r=n("9667"),a=n.n(r);a.a},"17f5":function(t,e,n){"use strict";var r=n("368f"),a=n.n(r);a.a},"20d6":function(t,e,n){"use strict";var r=n("5ca1"),a=n("0a49")(6),s="findIndex",i=!0;s in[]&&Array(1)[s](function(){i=!1}),r(r.P+r.F*i,"Array",{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(s)},"243f":function(t,e,n){var r=n("48a0");function a(t,e,n,a){return r(t,function(t,r,s){e(a,t,n(t),s)}),a}t.exports=a},"368f":function(t,e,n){},4151:function(t,e,n){var r=n("872a"),a=n("50c6"),s=a(function(t,e,n){r(t,n,e)});t.exports=s},"43ec":function(t,e,n){"use strict";var r=n("da92"),a=n.n(r);a.a},"48a0":function(t,e,n){var r=n("242e"),a=n("950a"),s=a(r);t.exports=s},"50c6":function(t,e,n){var r=n("a0c4"),a=n("243f"),s=n("badf"),i=n("6747");function o(t,e){return function(n,o){var c=i(n)?r:a,l=e?e():{};return c(n,t,s(o,2),l)}}t.exports=o},"616e":function(t,e,n){"use strict";var r=n("f8ec"),a=n.n(r);a.a},"67bd":function(t,e,n){},"94ac":function(t,e,n){"use strict";var r=n("a07a"),a=n.n(r);a.a},"950a":function(t,e,n){var r=n("30c9");function a(t,e){return function(n,a){if(null==n)return n;if(!r(n))return t(n,a);var s=n.length,i=e?s:-1,o=Object(n);while(e?i--:++i<s)if(!1===a(o[i],i,o))break;return n}}t.exports=a},9667:function(t,e,n){},a07a:function(t,e,n){},a0c4:function(t,e){function n(t,e,n,r){var a=-1,s=null==t?0:t.length;while(++a<s){var i=t[a];e(r,i,n(i),t)}return r}t.exports=n},b195:function(t,e,n){"use strict";var r=n("67bd"),a=n.n(r);a.a},da92:function(t,e,n){},ece7:function(t,e,n){"use strict";var r=n("f113"),a=n.n(r);a.a},f05a:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{id:"app-frame"}},[n("el-header",{attrs:{id:"app-header"}},[n("AppLogo"),n("div",{attrs:{id:"app-navbar"}},[n("AppProfile",{attrs:{fullname:t.fullname,avatar:t.avatar}})],1)],1),n("el-container",{attrs:{id:"app-container"}},[n("AppMenu",{attrs:{menus:t.menus}}),t.menus.length?n("div",{staticClass:"app-tagsview-container"},[n("TagsView"),n("AppMain")],1):t._e()],1)],1)},a=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-logo"},[t._v(t._s(t.title))])},i=[],o={name:"AppLogo",props:{title:{type:String,default:"智慧水务平台"}}},c=o,l=(n("17f5"),n("2877")),u=Object(l["a"])(c,s,i,!1,null,"a959c18e",null),f=u.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[n("div",{staticClass:"app-profile-toggle"},[n("el-avatar",{staticClass:"app-profile-avatar",attrs:{size:32,src:t.avatar}}),t._v(t._s(t.fullname)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"changePassword"}},[t._v("修改密码")]),n("el-dropdown-item",{attrs:{command:"logout",divided:""}},[t._v("退出登录")])],1)],1)},d=[],h={name:"AppProfile",props:{fullname:String,avatar:{type:String,default:"/app-profile-avatar.png"}},methods:{handleCommand:function(t){this[t]()},changePassword:function(){console.log("changePassword")},logout:function(){this.$router.push("logout")}}},v=h,m=(n("616e"),Object(l["a"])(v,p,d,!1,null,"4a224db1",null)),g=m.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-aside",{attrs:{id:"app-menu",width:"60px"}},[n("el-popover",{attrs:{placement:"right-start",width:"800",trigger:"hover"}},[n("el-input",{attrs:{placeholder:"请输入菜单名",size:"small"},model:{value:t.searchMenu,callback:function(e){t.searchMenu=e},expression:"searchMenu"}}),n("div",{staticClass:"menus-appstore"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("系统管理")]),n("div",{staticClass:"menus-appstore-list"},t._l(t.searchResultMenus,function(e){return n("router-link",{staticClass:"menus-appstore-item",attrs:{to:e.url}},[n("div",{staticClass:"menus-appstore-content"},[n("span",{staticClass:"iconfont",class:"icon"+e.icon}),t._v(" "+t._s(e.label))]),n("el-rate",{staticClass:"menus-appstore-start",attrs:{max:1,value:t._f("shortcutsFilter")(e._id,t.shortcuts)},on:{change:function(n){return t.changeShortcut(e._id)}}})],1)}),1)],1),n("div",{staticClass:"app-menu-item",attrs:{slot:"reference"},slot:"reference"},[n("span",{staticClass:"iconfont iconappstore"})])],1),t._l(t.shortcutMenus,function(t){return n("el-tooltip",{key:t._id,attrs:{effect:"dark",content:t.label,placement:"right"}},[n("router-link",{staticClass:"app-menu-item",attrs:{to:t.url}},[n("span",{staticClass:"iconfont",class:"icon"+t.icon})])],1)})],2)},b=[],$=(n("c5f6"),n("6762"),n("2fdb"),n("4151")),_=n.n($),y={name:"AppMenu",props:{menus:{type:Array,default:function(){return[]}}},data:function(){return{searchMenu:""}},computed:{searchResultMenus:function(){var t=this;return""===this.searchMenu?this.menus:this.menus.filter(function(e){var n=e.label;return n.includes(t.searchMenu)})},menusObject:function(){return this.menus.length?_()(this.menus,"_id"):{}},shortcuts:function(){return this.$store.getters.shortcuts},shortcutMenus:function(){var t=this;return this.shortcuts.map(function(e){return t.menusObject[e]})}},filters:{shortcutsFilter:function(t,e){return Number(e.includes(t))}},methods:{changeShortcut:function(t){this.$store.dispatch("user/changeShortcuts",t)}}},C=y,x=(n("b195"),Object(l["a"])(C,w,b,!1,null,"373618ca",null)),O=x.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-main",{attrs:{id:"app-main"}},[n("keep-alive",{attrs:{include:t.cachedViews}},[n("router-view",{key:t.key})],1)],1)},P=[],V={name:"AppMain",computed:{cachedViews:function(){return this.$store.state.tagsView.cachedViews},key:function(){return this.$route.path}}},k=V,A=(n("43ec"),Object(l["a"])(k,T,P,!1,null,"73ba7a4c",null)),M=A.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tags-view-container",attrs:{id:"tags-view-container"}},[n("scroll-pane",{ref:"scrollPane",staticClass:"tags-view-wrapper"},t._l(t.visitedViews,function(e){return n("router-link",{key:e.path,ref:"tag",refInFor:!0,staticClass:"el-tag el-tag--small tags-view-item",class:t.isActive(e)?"":"el-tag--info",attrs:{tag:"span",to:{path:e.path,query:e.query,fullPath:e.fullPath}},nativeOn:{mouseup:function(n){if("button"in n&&1!==n.button)return null;!t.isAffix(e)&&t.closeSelectedTag(e)},contextmenu:function(n){return n.preventDefault(),t.openMenu(e,n)}}},[t._v(t._s(e.title)),!t.isAffix(e)&&t.visitedViews.length>1?n("span",{staticClass:"el-tag__close el-icon-close",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.closeSelectedTag(e)}}}):t._e()])}),1),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"el-dropdown-menu el-dropdown-menu--small",style:{left:t.left+"px",top:t.top+"px"}},[t.isAffix(t.selectedTag)?t._e():n("li",{staticClass:"el-dropdown-menu__item",on:{click:function(e){return t.closeSelectedTag(t.selectedTag)}}},[t._v("关闭")]),n("li",{staticClass:"el-dropdown-menu__item",on:{click:t.closeOthersTags}},[t._v("关闭其它页面")])])],1)},L=[],S=(n("8e6e"),n("456d"),n("a481"),n("ac4d"),n("8a81"),n("ac6a"),n("bd86")),E=(n("7514"),n("7f7f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-scrollbar",{ref:"scrollContainer",staticClass:"scroll-container",attrs:{vertical:!1},nativeOn:{wheel:function(e){return e.preventDefault(),t.handleScroll(e)}}},[t._t("default")],2)}),D=[],W=(n("20d6"),4),F={name:"ScrollPane",data:function(){return{left:0}},computed:{scrollWrapper:function(){return this.$refs.scrollContainer.$refs.wrap}},methods:{handleScroll:function(t){var e=t.wheelDelta||40*-t.deltaY,n=this.scrollWrapper;n.scrollLeft=n.scrollLeft+e/4},moveToTarget:function(t){var e=this.$refs.scrollContainer.$el,n=e.offsetWidth,r=this.scrollWrapper,a=this.$parent.$refs.tag,s=null,i=null;if(a.length>0&&(s=a[0],i=a[a.length-1]),s===t)r.scrollLeft=0;else if(i===t)r.scrollLeft=r.scrollWidth-n;else{var o=a.findIndex(function(e){return e===t}),c=a[o-1],l=a[o+1],u=l.$el.offsetLeft+l.$el.offsetWidth+W,f=c.$el.offsetLeft-W;u>r.scrollLeft+n?r.scrollLeft=u-n:f<r.scrollLeft&&(r.scrollLeft=f)}}}},I=F,B=(n("94ac"),Object(l["a"])(I,E,D,!1,null,"5771c5b4",null)),R=B.exports;function q(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(n,!0).forEach(function(e){Object(S["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var J={name:"TagsView",components:{ScrollPane:R},data:function(){return{visible:!1,top:0,left:0,selectedTag:{},affixTags:[]}},computed:{visitedViews:function(){return this.$store.state.tagsView.visitedViews}},watch:{$route:function(){this.addTags(),this.moveToCurrentTag()},visible:function(t){t?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},mounted:function(){this.addTags()},methods:{isActive:function(t){return t.path===this.$route.path},isAffix:function(t){return t.meta&&t.meta.affix},addTags:function(){var t=this.$route,e=t.name,n=t.path;if(e){var r=this.$store.getters.menus.find(function(t){var e=t.url;return e===n}),a=r&&r.label;this.$store.dispatch("tagsView/addView",z({},this.$route,{title:a}))}return!1},moveToCurrentTag:function(){var t=this,e=this.$refs.tag;this.$nextTick(function(){var n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;if(o.to.path===t.$route.path){t.$refs.scrollPane.moveToTarget(o),o.to.fullPath!==t.$route.fullPath&&t.$store.dispatch("tagsView/updateVisitedView",t.$route);break}}}catch(c){r=!0,a=c}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}})},closeSelectedTag:function(t){var e=this;this.$store.dispatch("tagsView/delView",t).then(function(n){var r=n.visitedViews;e.isActive(t)&&e.toLastView(r,t)})},closeOthersTags:function(){var t=this;this.$router.push(this.selectedTag),this.$store.dispatch("tagsView/delOthersViews",this.selectedTag).then(function(){t.moveToCurrentTag()})},toLastView:function(t,e){var n=t.slice(-1)[0];n?this.$router.push(n.fullPath):"Dashboard"===e.name?this.$router.replace({path:"/redirect"+e.fullPath}):this.$router.push("/")},openMenu:function(t,e){var n=105,r=this.$el.getBoundingClientRect().left,a=this.$el.offsetWidth,s=a-n,i=e.clientX-r+15;this.left=i>s?s:i,this.top=e.clientY,this.visible=!0,this.selectedTag=t},closeMenu:function(){this.visible=!1}}},N=J,Y=(n("0bd3"),Object(l["a"])(N,j,L,!1,null,"2076ad24",null)),X=Y.exports,G={name:"AppFrame",components:{AppLogo:f,AppProfile:g,AppMenu:O,AppMain:M,TagsView:X},methods:{removeStartLoading:function(){document.getElementById("loading")&&document.body.removeChild(document.getElementById("loading"))}},computed:{menus:function(){return this.$store.getters.menus},fullname:function(){return this.$store.getters.fullname},avatar:function(){return this.$store.getters.avatar&&this.$store.getters.avatar.url}},created:function(){this.removeStartLoading()}},H=G,K=(n("ece7"),Object(l["a"])(H,r,a,!1,null,"f2ba85c6",null));e["default"]=K.exports},f113:function(t,e,n){},f8ec:function(t,e,n){}}]);
//# sourceMappingURL=appFrame.b4e75aec.js.map